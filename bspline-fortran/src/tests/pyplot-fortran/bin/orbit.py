#!/usr/bin/env python

import matplotlib
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
import numpy as np

matplotlib.rcParams["font.family"] = "Serif"
matplotlib.rcParams["font.size"] = 10
matplotlib.rcParams["axes.labelsize"] = 10
matplotlib.rcParams["xtick.labelsize"] = 10
matplotlib.rcParams["ytick.labelsize"] = 10
matplotlib.rcParams["legend.fontsize"] = 10

fig = plt.figure(figsize=(20,10),facecolor="white")
ax = fig.gca(projection='3d')
ax.grid()
ax.set_axisbelow(True)
ax.set_xlabel("x (km)")
ax.set_ylabel("y (km)")
ax.set_zlabel("z (km)")
ax.set_title("Orbit")

x = np.array([0.7000000000000000E+04,0.6999957353604533E+04,0.6999829414937763E+04,0.6999616185558585E+04,0.6999317668065130E+04,0.6998933866094739E+04,0.6998464784323918E+04,0.6997910428468282E+04,0.6997270805282480E+04,0.6996545922560122E+04,0.6995735789133671E+04,0.6994840414874348E+04,0.6993859810692009E+04,0.6992793988535003E+04,0.6991642961390038E+04,0.6990406743282017E+04,0.6989085349273867E+04,0.6987678795466357E+04,0.6986187098997901E+04,0.6984610278044350E+04,0.6982948351818769E+04,0.6981201340571207E+04,0.6979369265588442E+04,0.6977452149193730E+04,0.6975450014746531E+04,0.6973362886642219E+04,0.6971190790311793E+04,0.6968933752221560E+04,0.6966591799872818E+04,0.6964164961801517E+04,0.6961653267577913E+04,0.6959056747806208E+04,0.6956375434124175E+04,0.6953609359202776E+04,0.6950758556745759E+04,0.6947823061489254E+04,0.6944802909201345E+04,0.6941698136681633E+04,0.6938508781760792E+04,0.6935234883300105E+04,0.6931876481190992E+04,0.6928433616354523E+04,0.6924906330740919E+04,0.6921294667329041E+04,0.6917598670125870E+04,0.6913818384165965E+04,0.6909953855510916E+04,0.6906005131248786E+04,0.6901972259493535E+04,0.6897855289384431E+04,0.6893654271085456E+04,0.6889369255784693E+04,0.6885000295693701E+04,0.6880547444046880E+04,0.6876010755100821E+04,0.6871390284133648E+04,0.6866686087444341E+04,0.6861898222352053E+04,0.6857026747195408E+04,0.6852071721331795E+04,0.6847033205136639E+04,0.6841911260002671E+04,0.6836705948339176E+04,0.6831417333571232E+04,0.6826045480138943E+04,0.6820590453496647E+04,0.6815052320112122E+04,0.6809431147465776E+04,0.6803727004049824E+04,0.6797939959367453E+04,0.6792070083931975E+04,0.6786117449265972E+04,0.6780082127900418E+04,0.6773964193373798E+04,0.6767763720231215E+04,0.6761480784023478E+04,0.6755115461306180E+04,0.6748667829638771E+04,0.6742137967583608E+04,0.6735525954704997E+04,0.6728831871568233E+04,0.6722055799738601E+04,0.6715197821780403E+04,0.6708258021255932E+04,0.6701236482724471E+04,0.6694133291741248E+04,0.6686948534856406E+04,0.6679682299613939E+04,0.6672334674550630E+04,0.6664905749194971E+04,0.6657395614066075E+04,0.6649804360672567E+04,0.6642132081511476E+04,0.6634378870067099E+04,0.6626544820809875E+04,0.6618630029195218E+04,0.6610634591662368E+04,0.6602558605633207E+04,0.6594402169511077E+04,0.6586165382679578E+04])
y = np.array([0.0000000000000000E+00,0.2443455990656613E+02,0.4886882208573087E+02,0.7330248881372054E+02,0.9773526237401690E+02,0.1221668450609846E+03,0.1465969391834987E+03,0.1710252470685721E+03,0.1954514710649822E+03,0.2198753135468980E+03,0.2442964769175068E+03,0.2687146636126396E+03,0.2931295761043974E+03,0.3175409169047765E+03,0.3419483885692928E+03,0.3663516937006069E+03,0.3907505349521466E+03,0.4151446150317313E+03,0.4395336367051936E+03,0.4639173028000010E+03,0.4882953162088771E+03,0.5126673798934219E+03,0.5370331968877306E+03,0.5613924703020124E+03,0.5857449033262084E+03,0.6100901992336071E+03,0.6344280613844611E+03,0.6587581932296002E+03,0.6830802983140462E+03,0.7073940802806244E+03,0.7316992428735743E+03,0.7559954899421599E+03,0.7802825254442783E+03,0.8045600534500662E+03,0.8288277781455066E+03,0.8530854038360324E+03,0.8773326349501298E+03,0.9015691760429395E+03,0.9257947317998570E+03,0.9500090070401307E+03,0.9742117067204581E+03,0.9984025359385814E+03,0.1022581199936881E+04,0.1046747404105967E+04,0.1070900853988267E+04,0.1095041255281616E+04,0.1119168313842844E+04,0.1143281735691356E+04,0.1167381227012716E+04,0.1191466494162228E+04,0.1215537243668512E+04,0.1239593182237083E+04,0.1263634016753920E+04,0.1287659454289041E+04,0.1311669202100072E+04,0.1335662967635814E+04,0.1359640458539804E+04,0.1383601382653883E+04,0.1407545448021753E+04,0.1431472362892532E+04,0.1455381835724315E+04,0.1479273575187721E+04,0.1503147290169442E+04,0.1527002689775798E+04,0.1550839483336271E+04,0.1574657380407055E+04,0.1598456090774590E+04,0.1622235324459101E+04,0.1645994791718130E+04,0.1669734203050066E+04,0.1693453269197674E+04,0.1717151701151618E+04,0.1740829210153983E+04,0.1764485507701796E+04,0.1788120305550534E+04,0.1811733315717645E+04,0.1835324250486053E+04,0.1858892822407661E+04,0.1882438744306860E+04,0.1905961729284021E+04,0.1929461490718994E+04,0.1952937742274605E+04,0.1976390197900135E+04,0.1999818571834815E+04,0.2023222578611301E+04,0.2046601933059157E+04,0.2069956350308326E+04,0.2093285545792607E+04,0.2116589235253111E+04,0.2139867134741739E+04,0.2163118960624632E+04,0.2186344429585628E+04,0.2209543258629717E+04,0.2232715165086490E+04,0.2255859866613578E+04,0.2278977081200097E+04,0.2302066527170083E+04,0.2325127923185923E+04,0.2348160988251785E+04,0.2371165441717040E+04])
z = np.array([0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00,0.0000000000000000E+00])

ax.plot(x,y,z,"r-",linewidth=2,markersize=3,label="orbit")

u = np.linspace(0, 2 * np.pi, 500       )
v = np.linspace(0, np.pi, 500       )
x = 0.0000000000000000E+00 + 0.6378000000000000E+04 * np.outer(np.cos(u), np.sin(v))
y = 0.0000000000000000E+00 + 0.6378000000000000E+04 * np.outer(np.sin(u), np.sin(v))
z = 0.0000000000000000E+00 + 0.6378000000000000E+04 * np.outer(np.ones(np.size(u)), np.cos(v))
ax.plot_surface(x, y, z,antialiased=True,color="Blue")

ax.set_aspect("equal")

def set_axes_equal(ax):
    x_limits = ax.get_xlim3d()
    y_limits = ax.get_ylim3d()
    z_limits = ax.get_zlim3d()
    x_range = abs(x_limits[1] - x_limits[0])
    x_middle = np.mean(x_limits)
    y_range = abs(y_limits[1] - y_limits[0])
    y_middle = np.mean(y_limits)
    z_range = abs(z_limits[1] - z_limits[0])
    z_middle = np.mean(z_limits)
    plot_radius = 0.5*max([x_range, y_range, z_range])
    ax.set_xlim3d([x_middle - plot_radius, x_middle + plot_radius])
    ax.set_ylim3d([y_middle - plot_radius, y_middle + plot_radius])
    ax.set_zlim3d([z_middle - plot_radius, z_middle + plot_radius])
set_axes_equal(ax)

plt.savefig("orbit.png", dpi=200, transparent=True)

